---
{"dg-publish":true,"dg-home":true,"permalink":"/Index/","tags":["gardenEntry"],"dgPassFrontmatter":true}
---

# Generování atomických poznámek pomocí AI
Při budování znalostní báze (Knowledge Management) je kritickým bodem škálovatelnost. Manuální propojování poznámek a udržování kontextu, jak to vyžaduje například metoda Zettelkasten, se s rostoucím objemem dat stává neudržitelným a mohou snadno vznikat duplicity a nebo protichůdné poznámky.
Tento text popisuje technický experiment zaměřený na automatizaci při generování a propojení "chytrých" za pomocí agentového systému.
Řešení je postaveno na platformě [n8n](https://n8n.io) a celou flow lze rozdělit na dvě základní fáze:
1. Extrakce klíčových slov a jejich slovní popis.
2. Hledání vztahů mezi poznámkami a jejich propojení.
![Pasted image 20251227175833.png](/img/user/Pasted%20image%2020251227175833.png)
# Kroky pro generování poznámek
Pro extrakci pojmů je využit nód **Basic LLM Chain**. jehož vstupní prompt má za cíl na základě abstraktu představení a výsledků extrahovat klíčová slova a přiřadit jim vysvětlení. Prompt tak vypadá:
```
Jsi expertem na generování atomických poznámek. Jako vstup máš vědecký článek {{ $json.source_file }}.

Abstract:
{{ $json.abstract }}

Introduction:
{{ $json.introduction }}

Results:
{{ $json.results }}

Extrahuj 5-20 klíčových pojmů. Každý popiš 50-150 slov v češtině tak, aby byl atomický, neodkazoval se na původní text a jasně vysvětloval konkrétní pojem.

KRITICKY DŮLEŽITÉ - FORMÁT VÝSTUPU:
- Vrať POUZE validní JSON
- ŽÁDNÝ plain text
- ŽÁDNÉ číslování 1), 2), 3)
- ŽÁDNÉ markdown bloky ```
- Začni znakem { a skonči znakem }


Nyní extrahuj pojmy a vrať validní JSON
```
Poznámky jsou extrahovány za pomocí [OpenAI API]([https://openai.com), konkrétně modelu *GPT-5-mini*. Model byl zvolen z důvodu své vysoké rychlosti a nízkým nákladům. V mezičase, ještě před uložením, se kontroluje (a případně vytváří) kolekce pro vektorovou databázi *[Qdrant](https://qdrant.tech)*, do níž jsou následně ukládány jednotlivé poznámky, jež byly vygenerovány pomocí Basic LLM chain.
Embedding probíhá lokálně prostřednictvím *[Ollama](https://ollama.com/)* (voláno přes HTTP Request), s využitím modelu *bge-m3*. Jedná se o poměrně nový multijazyčný model, který je rychlý a generuje vektory o velikosti 1024 dimenzí.
Do vektorové databáze je následně ukládán název poznámky (title), vysvětlení (content), zdrojový soubor (sourceFile) a tagy vystihující danou poznámku (tags). Každá poznámka má své ID. V tomto případě byl zvolen ruční proces generování pomocí hashovací funkce *MD5* s cílem eliminovat duplicitní položky (zajistit, že se stejná poznámka nenahraje dvakrát).
```
[
    {
        "id": "{{ $('Crypto').item.json.data }}",
        "payload": {
            "title": "{{ $('Crypto').item.json.title }}",
            "content": "{{ $('Crypto').item.json.content }}",
            "sourceFile": "{{ $('Crypto').item.json.sourceFile }}",
            "tags": {{ JSON.stringify($('Crypto').item.json.tags) }}
        },
        "vector": {{ JSON.stringify($('Embedding').item.json.embedding) }}
    }
]
```
V druhé fázi AI agent za pomocí modelu GPT-4.1 postupně prochází jednotlivě vygenerované poznámky a nechává si je rovněž vytahovat z vektorové databáze včetně nejbližších sousedů. 
```
Jsi expert na propojování atomických poznámek v Zettelkasten systému.

VSTUPNÍ POZNÁMKA:
Název: {{ $('Crypto').item.json.title }}
Obsah: {{ $('Crypto').item.json.content }}
Tagy: {{ $('Crypto').item.json.tags }}

DOSTUPNÉ POZNÁMKY Z DATABÁZE:
{{ $json.result.points.map((p, i) => `${i+1}. "${p.payload.title}"`).join('\n') }}

ÚKOL:
Analyzuj poznámky ze seznamu výše a najdi ty, které jsou **tematicky propojené** se vstupní poznámkou.

KRITÉRIA:
- Sdílejí společné technologie, koncepty nebo domény
- Doplňují nebo rozšiřují vstupní poznámku
- Vyber maximálně 5 nejlepších propojení
- Seřaď podle relevance (nejvíce související první)

KRITICKÉ PRAVIDLO:
V poli relatedNotes[].title MUSÍŠ použít PŘESNĚ názvy ze seznamu "DOSTUPNÉ POZNÁMKY".
ZKOPÍRUJ celý řetězec včetně diakritiky.
NIKDY nevymýšlej vlastní názvy.
Pokud není souvislost, vrať prázdné pole relatedNotes: []
``` 
Na základě toho AI agent vyhodnotíP jejich relevanci a vytvoří propojení, jež dále odůvodní.
# Příklad
Flow byla testována na celkem na těchto článcích zaměřených primárně na chytrou domácnost, agentový přístup a Arduino:
- [[Amine et al. - 2018 - Smart Home Automation System based on Arduino.pdf]],
- [[Naing - 2019 - 56 Arduino Based Smart Home Automation System.pdf]],
- [[Vardakis et al. - 2022 - Smart Home Deep Learning as a Method for Machine .pdf]], 
- [[Zhao et al. - 2019 - BIM Sim3D Multi-Agent Human Activity Simulation .pdf]]).
# Dotazování LLM a vyhledávání ve vektorové DB
Kromě generování obsahu lze LLM využít k dotazování nad konkrétními poznámkami, jejich vysvětlování či vyhledávání. K tomuto účelu efektivně slouží vytvořená vektorová databáze. S cílem maximalizovat úsporu tokenů a umožnit běh na běžném PC byly pro srovnání vybrány čtyři lokální modely.
Každému modelu byly položeny tyto otázky:
- Co je to agent? - Cílem bylo nalézt a čerpat z [[Agent-based simulace]]
- Co je to fog-cloud computing? - Cílem bylo nalézt a čerpat z [[Fog a Cloud computing]]
- Jaké senzory jsme schopni integrovat do Arduina? - Cílem bylo nalézt a čerpat z [[Integrace senzorů a aktorů]]
- Jaká je aktuální cena modulu ESP32 na českém trhu? Cílem bylo odpovědět, že taková poznámka neexistuje, nebo že nemá přístup k těmto informacím.
Jednotlivé odpovědi jsou zaznamenány v tabulkách. Testování probíhalo s vektorovou databází i bez ní pro porovnání přesnosti. Zvoleny byly modely [[Llama 3.1 8b]], [[MIstral-memo]], náročnější reasoning model [[DeepSeek-r1]] a na závěr model od OpenAI [[gpt-oss]]. Po rozkliknutí každého modelu je k dispozici srovnávací tabulka.
Pro modely bez RAG byl nastaven systémový prompt:
```
Jsi odborný asistent, který odpovídá na otázky uživatelů na základě svých znalostí.

Když obdržíš dotaz od uživatele, odpověz co nejpřesněji a nejsrozumitelněji.

DŮLEŽITÉ PRAVIDLO:
Pokud si nejsi jistý odpovědí nebo nemáš dostatečné znalosti k zodpovězení dotazu, jasně to přiznej. Napiš "Nevím" nebo "Nemám dostatečné informace k zodpovězení této otázky" a NIKDY si nevymýšlej.
```
Naopak pro modely, které měly k dispozici vektorovou DB:
```
Jsi odborným asistentem, který primárně čerpá ze své znalostní báze z Qdrant databázené, kterou máš k dispozici.
Jakmile obdržíš dotaz ud uživatele, tak napřed projdi svou znáslostí bázi z vektorového Databáze a pokud najdeš relevantní poznámku, tak na jejím základě odpověz. Na konci rovněž uveď zdroj, odkud jsi čerpal (název poznámky). V případě, že konkrétní znalost nenajdeš v databázi, tak napiš, že nevíš, nebo že daná poznámka není evidovaná v databázi a nevymýšlej si.
```
Cílem bylo porovnat jejich kvalitu, přesnost a schopnost, jak umí pracovat s vektorovou databázi (znalostní bází). Zde je srovnávací tabulka s modely, které pro svou odpověď aktivně vyžívaly vektorovou databázi. 

| otázka                                             | Llama 3.1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Mistral                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | DeepSeek                                                                                                                                                                                                                                                                                                                                                                        | gpt-oss                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| -------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Co je to agent?                                    | Agent je v kontextu vnitřních prostor nebo multi-agentních systémů autonomní entita, která má své cíle, schopnosti a rozhodovací pravidla. Reprezentuje jedince pohybujícího se, vykonávající úkoly a reagující na okolí. Agenti jsou konfigurovány rozdílnými rolemi, prioritami a časovými profily, což umožňuje studovat emergentní jevy, interakce mezi lidmi a prostorovými prvky, a generovat detailní stopy aktivit.  <br>  <br>Zdroj: https://www.example.com/agent-based-simulation  <br>  <br>(Poznámka: Zdroj je pouze jednoduchý příklad a v reálném případě by se měl vyhledat přesnější zdroj. | Agent je v kontextu simulací modelování chování systému jako souhrn autonomních entit zvaných agenti, z nichž každý má své cíle, schopnosti a rozhodovací pravidla. V prostorách reprezentují jedince pohybující se, vykonávající úkoly a reagující na okolí.  <br>  <br>Zdroj: [Retrieve]                                                                                                                                                                                                                                                                                                                                             | Agent je v kontextu simulace modelování chování systému jako souhrn autonomních entit zvaných agenti, které mají své cíle, schopnosti a rozhodovací pravidla. V prostředí budov reprezentují jedince pohybující se, vykonávající úkoly a reagující na okolí.  <br>  <br>Zdroj: Qdrant DB1 (poznámka 5f208749-c327-905e-b4b1-b9cff78ec85e)                                       | We have multiple relevant notes. Need to summarize what is agent. Provide source. Likely first note about agent-based simulation. Provide reference: "Agent-based simulace". So answer in Czech.**Agent**  <br>V kontextu simulací a multi‑agentních systémů je *agent* autonomní entita, která:  <br>  <br>1. **Má vlastní cíle** – co chce dosáhnout nebo jaký úkol splnit.  <br>2. **Vlastní schopnosti** – jaké akce může vykonávat (pohybovat se, používat nástroje, komunikovat atd.).  <br>3. **Rozhodovací pravidla** – jak na základě vnitřních stavů a exteriéru řeší problémy a volí akce.  <br>  <br>V agent-based (agent‑based) simulaci se celý systém modeluje jako souhra těchto jednotlivých agentů. Každý agent působí nezávisle, interaguje s okolím a s ostatními agenty, a tím vznikají emergentní jevy, které lze studovat (například vývoj trávících toků, úkoly v budovách nebo interakce lidí s prostředím).  <br>  <br>> **Zdroj:** *Agent-based simulace modeluje chování systému jako souhrn autonomních entit zvaných agenti* (poznámka Qdrant).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Co je to fog-cloud computing?                      | Fog-cloud computing je koncepce, která kombinuje distribuované výpočetní zdroje v cloudu a na hrany sítě (fog) pro zpracování dat v IoT a chytrých domech. Edge/fog vrstva umisťuje výpočet blíže k senzorům a uživatelům, snižuje latenci a zátěž sítě, zatímco cloud nabízí škálovatelné úložiště a výpočet pro náročné modely.  <br>  <br>Zdroj: [PageContent](https://www.example.com/page-content)                                                                                                                                                                                                      | Fog-cloud computing je kombinace technologie fog computing ( Edge/Fog vrstva) a cloud computing. Fog computing se snaží umístit výpočetní zdroje blíže k senzorům a uživatelům, aby se snížila latence a zátěž sítě. Cloud computing zase nabízí škálovatelné úložiště a výpočet pro náročné modely. Kombinace těchto dvou technologií umožňuje rychlé vyhodnocení alarmů lokálně a souběžné trénování nebo archivaci v cloudu.  <br>  <br>Zdroj: [1] (Neznámý zdroj, pouze text z databáze)                                                                                                                                           | Odpověď:  <br>  <br>Fog-cloud computing je kombinace distribuovaných výpočetních zdrojů pro zpracování dat v IoT a chytrých domech. Edge/fog vrstva umísťuje výpočet blíže k senzorům a uživatelům, snižuje latenci a zátěž sítě, zatímco cloud nabízí škálovatelné úložiště a výpočet pro náročné modely.  <br>  <br>Zdroj: Qdrant databáze, poznámka: "Fog a cloud computing" | We got relevant snippet: fog and cloud computing description. Provide answer and cite source: The page id. We can identify likely note name: maybe "Fog a cloud computing" etc. We'll reference that.Fog‑cloud computing je architektura, která kombinuje výpočetní a ukládací zdroje, které se nacházejí jak „blízko“ k IoT zařízeníům (edge/fog vrstva), tak v centrálních datových centrech (cloud).  <br>  <br>* **Fog (edge) vrstva** – umisťuje výpočet a rychlé zpracování přímo v blízkosti senzorů a uživatelů. Tím se redukuje latence, šetří šířka pásma a lze lépe řídit otázky soukromí.  <br>* **Cloud vrstva** – poskytuje elastické úložiště a výpočetní kapacitu pro náročné úlohy, například trénování modelů, archivaci dat nebo souběžnou analýzu.  <br>  <br>V praxi se využívá k rychlému vyhodnocení alarmů a rozhodnutí lokálně, zatímco složitější úkoly (např. školení neuronových sítí) se provádějí v cloudu. Klíčové je rozhodovat, která data zpracovat lokálně kvůli latenci a soukromí, a která poslat do vzdálených center.  <br>  <br>**Zdroj:** *Fog a cloud computing* (poznámka v databázi).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Jaké senzory jsme schopni integrovat do Arduina?   | Arduino umožňuje integrovat širokou škálu senzorů. Některé z podporovaných senzorů jsou:  <br>  <br>* Teplotní senzory (například DHT11) pro měření teploty a relativní vlhkosti  <br>* Pohybové senzory (PIR) pro detekci pohybu osob  <br>* Světelné senzory pro měření světla  <br>* Teplotní senzory pro měření okolní teploty  <br>  <br>Je důležité poznamenat, že výběr vhodného senzoru záleží na konkrétním použití a požadavcích projektu.  <br>  <br>Zdroj: Arduino Wiki                                                                                                                          | Podle databáze Arduino jsou podporovány následující senzory:  <br>  <br>* Teplotní a vlhkostní senzor DHT11  <br>* Senzory pro čtení teploty, světla a pohybu (typicky z rodiny DS18B20, BH1750 a PIR)  <br>* Senzory pro měření tlaku, úrovně vody a dalších parametrů  <br>  <br>Je také důležité zmínit, že Arduino je velmi flexibilní platforma, která umožňuje integraci širokého spektra senzorů a modulů prostřednictvím knihoven a modulárních připojení. Proto může být použita pro řadu aplikací, od domácích automatizačních systémů až po komerční systémy.  <br>  <br>Zdroj: [1] Arduino - Otevřená hardwarová platforma | Arduino umožňuje integrovat široké spektrum senzorů, jako jsou teplotní (DHT11), světelné (LDR) a pohybové (PIR) senzory. Tyto senzory lze použít k čtení vstupů a řízení výstupů v domácích automatizačních systémech.  <br>  <br>Zdroj: Vyhledáno v databázi Qdrant, záznam ID 67c7d220-8459-eb61-a893-db265c9f74e7.                                                          | We retrieved text snippets about Arduino integration and sensors. Need to answer user question: "Jaké senzory jsme schopni integrovat do Arduina?" meaning "Which sensors can we integrate into Arduino?" Provide answer, citing source(s). Use the provided snippet about sensors and integration. We'll mention typical sensors: temperature (DHT11, DHT22, DS18B20), light (LDR, photodiode), motion (PIR), humidity, proximity (IR). Also mention others like accelerometer, gyroscope, pressure, etc. We can cite the retrieved chunks. Let's use chunk id 6b1ef60b... "Integrace senzorů a aktorů..." and also 67c7d220... about sensors in home automation. Provide answer in Czech. Let's produce answer.**Senzory, které můžeme k Arduinu snadno integrovat:**  <br>  <br>\| Kategorie \| Typ senzor \| Popis a typické použití \|  <br>\|-----------\|------------\|------------------------\|  <br>\| **Teplota / vlhkost** \| DHT11 / DHT22 (digital) <br> DS18B20 (digitální, 1‑wire) \| Měří okolní teplotu a (pokud je DHT) vlhkost vzduchu – ideální pro termostaty, klimatizační systémy nebo klimatické stanoviště. \|  <br>\| **Světlo / světelný podíl** \| LDR (fotorezistor) <br> Fotodiode \| Měří intenzitu světla – běžně pro automatické stmívání osvětlení nebo pro senzor nastavení osvětlení. \|  <br>\| **Pohyb** \| PIR (passive infrared) \| Detekuje pohyb člověka v okolí – často se používá k aktivaci osvětlení, bezpečnostním alarmům a úsporným režimům. \|  <br>\| **Základní digitální čidla** \| Button (tlačítko), optický nebo magnetický reed kontak \| Jednoduché vstupy pro ovládání a detekci mechanických pohybů. \|  <br>\| **Proximate / blízkost** \| HC‑05 / HC‑06 (Bluetooth) <br> IR‑receiver \| Detekuje objekty na krátké vzdálenosti, například pro dálkové ovládání nebo robotiku. \|  <br>\| **Zatížení a tlak** \| BMP280 / BMP180 (barometrický a teplotní) \| Měří atmosférický tlak a teplotu – vhodné pro meteorologické stanice a altitude měření. \|  <br>\| **Zrychlení a rotace** \| MPU9250 / MPU6050 (akcelerometr + gyroskop) \| Slouží pro sledování orientace, pohybové řízení robotů, a detekci vibrací. \|  <br>\| **Kouř / kvalita ovzduší** \| DUST‑TRAK, MQ‑2, MQ‑135 \| Senzory kvality ovzduší a detekce plynných látek, které lze použít pro domácí monitorování. \|  <br>\| **Hlas** \| MEMS mikrofon \| Umožňuje detekci a záznam zvuku – často doplňové pro hlasové ovládání. \|  <br>  <br>Arduina se snadno **rozšiřují** pomocí rozhraní **I²C, SPI, UART** či **přímých digitálních/pin‑analogových portů**, takže výše uvedené senzory se připojují jený pomocí několika vodičů a knihoven. V domácí automatizaci se nejčastěji používají kombinace: **teplota (DHT11), světlo (LDR), a pohyb (PIR)**, které určují, kdy se zapíná osvětlení nebo se spouští regulace klimatizace (zdroj: *Integrace senzorů a aktorů*).  <br>  <br>**Zdroj:** *Integrace senzorů a aktorů* (ID: 6b1ef60b‑72e5‑928c‑c1cf‑7477469cd414). |
| Jaká je aktuální cena modulu ESP32 na českém trhu? | Nevím, nebo je to daná poznámka evidovaná v databázi a nevymýšlím si.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Nevím, jaká je aktuální cena modulu ESP32 na českém trhu. Je možné, že daná poznámka není evidovaná v databázi a nevymýšlím si. Protože dané poznatky jsou o jiných elektronických modulech než ESP32, nemohu poskytnout relevantní odpověď.                                                                                                                                                                                                                                                                                                                                                                                           | Nevím, jakou konkrétní cenu modulu ESP32 na českém trhu jste požadovali. Mohla by vás zajímat cena v jiných regionech nebo aktuální cena některých dalších komponent?                                                                                                                                                                                                           | We need to answer user's question: "Jaká je aktuální cena modulu ESP32 na českém trhu?" It's likely that the knowledge base doesn't have this specific information. The vector DB returned irrelevant notes. So answer that info not found in db.Nevíte, že aktuální cenu modulu ESP32 na českém trhu vám nemohu poskytnout, protože v naší databázi není evidovaná žádná poznámka týkající se jeho ceny. Pokud budete potřebovat tuto informaci, doporučuji se podívat na aktuální nabídky v českých obchodech s elektronikou nebo na internetové obchody se specializací na mikrokontroléry.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
# Problémy a jejich návrh řešení
- duplicita poznámek - v případě, zpracování dalších článků, v níž se opakují pojmy, začnou vznikat duplicity, které pro systém se tváří jako dvě odlišné poznámky. Řešení průběžná kontrola nejen vektorové databáze, ale také fyzických poznámek a její sjednocení pomocí LLM. Tento fakt lze například zaznamenat u poznámek [[Notes/Arduino Nano\|Arduino Nano]] a [[Notes/Arduino (mikrokontrolér)\|Arduino (Mikrokontrolér)]], kdy dokument [[Naing - 2019 - 56 Arduino Based Smart Home Automation System.pdf]] byl zpracováván dodatečné.
- Přístup k API službám (OpenAI) - lze řešit lokálně, ale z důvodu slabého HW je proto vhodné využívat API. Výsledky jsou mnohem rychlejší a přesnější.